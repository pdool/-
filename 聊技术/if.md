if (你看这篇文章)  你会获得一些if优化技巧，else 写不好if

今天是2020年1024，程序员的节日，祝大家节日快乐，最近在代码review的过程中发现了一些问题，这些问题虽然不影响逻辑，但是对代码的可读性，安全性留下了隐患。今天这篇文章写在纸上写了好多天，一直放在口袋里，一直工作比较忙没时间写，今天加个班写一下。

if 是每个语言都有的语法，也是最基础的语法。因为代码本来就很晦涩，所以才有了程序员这个中间件，码农。怎么样才能写出好读的，不容易出错的代码？不人为的增加代码的难度呐？这是一个大问题。今天就聊一下我的一些关于 if 思路和总结。

## 1、if 合并

使用逻辑运算符进行合并if。简单的if 嵌套可以使用&& 进行合并。简单的if else 并且操作相同可以使用 || 进行合并，优化代码逻辑，增加可读性。



![image-20201021223518655](D:\wechat\gameWathcer\img\20201021\2.png)

![image-20201021224142191](D:\wechat\gameWathcer\img\20201021\3.png)

注意：逻辑运算符的截断性，if(a >= 10 || b >= 20) 当a>= 10 成立时 是不会判断后面的，只要条件成立，则if 判断结束。

因此简单判断放在最前面，在开发的过程中，将简单的逻辑判断前置，减少判断的次数，可以提高性能，提高性能！

## 2、将正常的流程放在函数的主干执行

在开发中有些同学会跟着策划写逻辑，将策划的功能描述进行直接转码，造成了很多判断的嵌套。

在这时可以将代码逻辑进行整理，先进行check ,各种不符合条件的判断提前判断并结束函数，最基本的原则就是：将最后的主逻辑留在函数的主干内。

比如下面的场景：玩家需要达到等级100，并且拥有足够的体力，才能够参与活动，否则的话则报错误码。

![image-20201021225747559](D:\wechat\gameWathcer\img\20201021\4.png)



可以看到 主逻辑 doSomeThing 在第一处的时候if的嵌套层数是2层，在第二处的时候 嵌套层数 是0 层。在阅读的代码的时候，可以直接顺序读下去，将不太需要关注的分支跳过即可，可读性有了优化，代码更优雅。



## 3、减少if

 ### 1. 使用三元运算符表达式

比如在战斗的时候，需要根据玩家的等级进行战斗力的放大，所有有下面的代码，可以看到用三元运算符代码行数较少，而且逼格显然比较高。
    
![image-20201021230503486](D:\wechat\gameWathcer\img\20201021\5.png)

### 2.使用java8 中流过滤filter ，不使用if

在开发的过程中需要过滤某一个类型的道具，在背包内查找满足需要的道具。

下面的代码传入需要过滤的道具类型，然后在第一处的地方模拟了背包的数据，

第二处是使用if的过滤。

第三处是使用stream 进行过滤，可以看到使用java8 避免了使用if判断，函数式的接口，优雅并且易于理解。



![image-20201021231743455](D:\wechat\gameWathcer\img\20201021\6.png)



### 3、使用枚举

枚举是我们项目里用的很多的一种解决办法，比如我们的资源管理，任务管理，组队管理等等功能，都是使用了枚举解决if else 问题，当你面对的一个同样的问题，只是因为类型的不同的时候，则可以使用枚举进行优化代码。

下面的枚举定义了一个抽象方法，由每个枚举单独实现。

![image-20201021233115519](D:\wechat\gameWathcer\img\20201021\7.png)

![image-20201021233250802](D:\wechat\gameWathcer\img\20201021\8.png)

在使用的时候可以直接使用对应的枚举进行操作，不需要使用if 进行操作，是不是很方便？同时在以后扩展的时候只要增加枚举，不需要修改原来的代码？降低了出bug的风险。

### 4、使用manager

同样的问题，也可以使用manager进行解决，思路就是将对应类型的处理类先进行注册，等用的时候直接从map中获取，然后使用，避免了if 的判断。

比如上期的资源系统，就是使用了manager 进行的处理。在游戏启动的时候注册了每种资源的处理类，所有的资源类都继承了同样的接口，在使用的时候可以直接调用相同的接口，这样就没必要尽心if 判断。

![image-20201016221057227](D:\wechat\gameWathcer\img\20201016\5.png)

### 5、使用Consumer

比如战斗的时候，需要根据战斗的类型不同，然后有不同的处理函数，在这时候可以使用Consumer，将每个单独的类型单独处理。避免了使用if

![image-20201024212901708](D:\wechat\gameWathcer\img\20201021\9.png)



## 总结：

if 很简单，但是也有一些技巧。毕竟编程语言的创造者创造简单的if，for 就表示了这世界所有的逻辑。用好if，增加代码可读性，让自己的代码更优雅，Bug 更少。写篇文章不容易，希望能获得大家的关注，点赞，转发 三连，谢谢。

 常规福利时间

